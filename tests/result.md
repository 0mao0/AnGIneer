# SOP æ‰§è¡Œæ—¥å¿— (LLM é£æ ¼å°ç»“ç‰ˆ)

> **è¯´æ˜**: æœ¬æ—¥å¿—å±•ç¤ºäº†æ¯ä¸€æ­¥çš„æ‰§è¡Œå°ç»“ä¸ Blackboard çŠ¶æ€å¿«ç…§ã€‚æ›´æ–°çš„å†…å®¹å·²é«˜äº®æ˜¾ç¤ºã€‚

---

## step_1: è·å–è®¾è®¡èˆ¹å‹æ»¡è½½åƒæ°´ T

**LLM å°ç»“**:

åœ¨æ­¥éª¤â€œè·å–è®¾è®¡èˆ¹å‹æ»¡è½½åƒæ°´ Tâ€ä¸­ï¼Œæˆ‘æŸ¥é˜…äº† **è¡¨ A.0.1**ã€‚æ ¹æ®æ¡ä»¶ èˆ¹å‹=æ²¹èˆ¹, å¨çº§=100000ï¼ŒæˆåŠŸè·å–åˆ°æ•°æ®ï¼Œæ›´æ–°äº†ï¼šT=15.0ã€‚

**Blackboard çŠ¶æ€**:

| Key | Value | Status |
| --- | --- | --- |
| **T** | **15.0** | ğŸŸ¢ Updated |
| H_nav | 0.5 | |
| bottom_material | å²©çŸ³ | |
| dwt | 100000 | |
| nav_speed_kn | 10 | |
| navigation_area | å—é™æ°´åŸŸ | |
| water_depth | 20.0 | |
| èˆ¹å‹ | æ²¹èˆ¹ | |

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å·¥å…·è°ƒç”¨è¯¦æƒ…</summary>

**è¯´æ˜**: æ ¹æ®èˆ¹å‹ä¸å¨çº§æŸ¥è¡¨ A.0.1

**å·¥å…·**: `table_lookup`

**è¾“å…¥**:
```json
{
  "table_name": "è¡¨ A.0.1",
  "query_conditions": {
    "èˆ¹å‹": "æ²¹èˆ¹",
    "å¨çº§": 100000
  },
  "file_name": "æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md",
  "target_column": "æ»¡è½½åƒæ°´ T"
}
```

**è¾“å‡º**:
```json
{
  "_source_html": "",
  "_table_name": "è¡¨ A.0.1",
  "_table_headers": [
    "å¨çº§ (DWT)",
    "èˆ¹å‹",
    "æ»¡è½½åƒæ°´ T (m)"
  ],
  "_table_context": "### è¡¨ A.0.1 è®¾è®¡èˆ¹å‹æ»¡è½½åƒæ°´ T",
  "_trace": [
    "åŠ è½½çŸ¥è¯†åº“æ–‡ä»¶: æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md",
    "è¡¨æ ¼é€‰æ‹©ç­–ç•¥: Markdown ä¸Šä¸‹æ–‡å…¨åŒ¹é…",
    "åŒ¹é…è¡¨å: è¡¨ A.0.1",
    "åŒ¹é…è¡¨æ ¼ä¸Šä¸‹æ–‡: ### è¡¨ A.0.1 è®¾è®¡èˆ¹å‹æ»¡è½½åƒæ°´ T",
    "è§£æè¡¨å¤´: ['å¨çº§ (DWT)', 'èˆ¹å‹', 'æ»¡è½½åƒæ°´ T (m)']",
    "æ–‡æœ¬æ¡ä»¶è¿‡æ»¤: {'èˆ¹å‹': 'æ²¹èˆ¹'}",
    "æ¡ä»¶åˆ—åŒ¹é…: å¨çº§ -> Col 0, Val 100000.0",
    "æœ€ä½³è¡ŒåŒ¹é…è·ç¦»: 0.0"
  ],
  "result": 15.0,
  "method": "best_match_value"
}
```

</details>

---

## step_2: è·å–èˆªè¡Œä¸‹æ²‰é‡ Z0

**LLM å°ç»“**:

åœ¨æ­¥éª¤â€œè·å–èˆªè¡Œä¸‹æ²‰é‡ Z0â€ä¸­ï¼Œæˆ‘æŸ¥é˜…äº† **å›¾ 6.4.6**ã€‚æ ¹æ®æ¡ä»¶ èˆªé€Ÿ=10, æ°´æ·±=20.0ï¼ŒæˆåŠŸè·å–åˆ°æ•°æ®ï¼Œæ›´æ–°äº†ï¼šZ0=0.5ã€‚

**Blackboard çŠ¶æ€**:

| Key | Value | Status |
| --- | --- | --- |
| **Z0** | **0.5** | ğŸŸ¢ Updated |
| H_nav | 0.5 | |
| T | 15.0 | |
| bottom_material | å²©çŸ³ | |
| dwt | 100000 | |
| nav_speed_kn | 10 | |
| navigation_area | å—é™æ°´åŸŸ | |
| water_depth | 20.0 | |
| èˆ¹å‹ | æ²¹èˆ¹ | |

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å·¥å…·è°ƒç”¨è¯¦æƒ…</summary>

**è¯´æ˜**: æ ¹æ®èˆªé€Ÿ/æ°´æ·±æŸ¥å›¾ 6.4.6

**å·¥å…·**: `table_lookup`

**è¾“å…¥**:
```json
{
  "table_name": "å›¾ 6.4.6",
  "query_conditions": {
    "èˆªé€Ÿ": 10,
    "æ°´æ·±": 20.0
  },
  "file_name": "æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md"
}
```

**è¾“å‡º**:
```json
{
  "_source_html": "",
  "_table_name": "å›¾ 6.4.6",
  "_table_headers": [
    "èˆªé€Ÿ (kn)",
    "æ°´æ·± (m)",
    "Z0 (m)"
  ],
  "_table_context": "å›¾ 6.4.6 èˆªè¡Œä¸‹æ²‰é‡ Z0 å‚è€ƒå€¼",
  "_trace": [
    "åŠ è½½çŸ¥è¯†åº“æ–‡ä»¶: æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md",
    "è¡¨æ ¼é€‰æ‹©ç­–ç•¥: Markdown ä¸Šä¸‹æ–‡å…¨åŒ¹é…",
    "åŒ¹é…è¡¨å: å›¾ 6.4.6",
    "åŒ¹é…è¡¨æ ¼ä¸Šä¸‹æ–‡: å›¾ 6.4.6 èˆªè¡Œä¸‹æ²‰é‡ Z0 å‚è€ƒå€¼",
    "è§£æè¡¨å¤´: ['èˆªé€Ÿ (kn)', 'æ°´æ·± (m)', 'Z0 (m)']",
    "æ–‡æœ¬æ¡ä»¶è¿‡æ»¤: {}",
    "æ¡ä»¶åˆ—åŒ¹é…: èˆªé€Ÿ -> Col 0, Val 10.0",
    "æ¡ä»¶åˆ—åŒ¹é…: æ°´æ·± -> Col 1, Val 20.0",
    "æœ€ä½³è¡ŒåŒ¹é…è·ç¦»: 0.0",
    "è‡ªåŠ¨æ¨æ–­ç›®æ ‡åˆ—: Z0 (m)"
  ],
  "result": 0.5,
  "method": "best_match_value"
}
```

</details>

---

## step_3: è·å–é¾™éª¨ä¸‹æœ€å°å¯Œè£•æ·±åº¦ Z1

**LLM å°ç»“**:

åœ¨æ­¥éª¤â€œè·å–é¾™éª¨ä¸‹æœ€å°å¯Œè£•æ·±åº¦ Z1â€ä¸­ï¼Œæˆ‘æŸ¥é˜…äº† **è¡¨ 6.4.6-1**ã€‚æ ¹æ®æ¡ä»¶ å¨çº§=100000, åœŸè´¨=å²©çŸ³ï¼ŒæˆåŠŸè·å–åˆ°æ•°æ®ï¼Œæ›´æ–°äº†ï¼šZ1=0.8ã€‚

**Blackboard çŠ¶æ€**:

| Key | Value | Status |
| --- | --- | --- |
| **Z1** | **0.8** | ğŸŸ¢ Updated |
| H_nav | 0.5 | |
| T | 15.0 | |
| Z0 | 0.5 | |
| bottom_material | å²©çŸ³ | |
| dwt | 100000 | |
| nav_speed_kn | 10 | |
| navigation_area | å—é™æ°´åŸŸ | |
| water_depth | 20.0 | |
| èˆ¹å‹ | æ²¹èˆ¹ | |

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å·¥å…·è°ƒç”¨è¯¦æƒ…</summary>

**è¯´æ˜**: æ ¹æ® DWT ä¸åœŸè´¨æŸ¥è¡¨ 6.4.6-1

**å·¥å…·**: `table_lookup`

**è¾“å…¥**:
```json
{
  "table_name": "è¡¨ 6.4.6-1",
  "query_conditions": {
    "å¨çº§": 100000,
    "åœŸè´¨": "å²©çŸ³"
  },
  "file_name": "æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md"
}
```

**è¾“å‡º**:
```json
{
  "_source_html": "",
  "_table_name": "è¡¨ 6.4.6-1",
  "_table_headers": [
    "å¨çº§ (DWT)",
    "åœŸè´¨",
    "Z1 (m)"
  ],
  "_table_context": "è¡¨ 6.4.6-1 é¾™éª¨ä¸‹æœ€å°å¯Œè£•æ·±åº¦ Z1",
  "_trace": [
    "åŠ è½½çŸ¥è¯†åº“æ–‡ä»¶: æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md",
    "è¡¨æ ¼é€‰æ‹©ç­–ç•¥: Markdown ä¸Šä¸‹æ–‡å…¨åŒ¹é…",
    "åŒ¹é…è¡¨å: è¡¨ 6.4.6-1",
    "åŒ¹é…è¡¨æ ¼ä¸Šä¸‹æ–‡: è¡¨ 6.4.6-1 é¾™éª¨ä¸‹æœ€å°å¯Œè£•æ·±åº¦ Z1",
    "è§£æè¡¨å¤´: ['å¨çº§ (DWT)', 'åœŸè´¨', 'Z1 (m)']",
    "æ–‡æœ¬æ¡ä»¶è¿‡æ»¤: {'åœŸè´¨': 'å²©çŸ³'}",
    "æ¡ä»¶åˆ—åŒ¹é…: å¨çº§ -> Col 0, Val 100000.0",
    "æœ€ä½³è¡ŒåŒ¹é…è·ç¦»: 0.0",
    "è‡ªåŠ¨æ¨æ–­ç›®æ ‡åˆ—: Z1 (m)"
  ],
  "result": 0.8,
  "method": "best_match_value"
}
```

</details>

---

## step_4: è·å–æ³¢æµªå¯Œè£•æ·±åº¦ Z2

**LLM å°ç»“**:

åœ¨æ­¥éª¤â€œè·å–æ³¢æµªå¯Œè£•æ·±åº¦ Z2â€ä¸­ï¼Œæˆ‘æŸ¥é˜…äº† **è¡¨ 6.4.6-2**ã€‚æ ¹æ®æ¡ä»¶ æ°´åŸŸæ¡ä»¶=å—é™æ°´åŸŸï¼ŒæˆåŠŸè·å–åˆ°æ•°æ®ï¼Œæ›´æ–°äº†ï¼šZ2=0.4ã€‚

**Blackboard çŠ¶æ€**:

| Key | Value | Status |
| --- | --- | --- |
| **Z2** | **0.4** | ğŸŸ¢ Updated |
| H_nav | 0.5 | |
| T | 15.0 | |
| Z0 | 0.5 | |
| Z1 | 0.8 | |
| bottom_material | å²©çŸ³ | |
| dwt | 100000 | |
| nav_speed_kn | 10 | |
| navigation_area | å—é™æ°´åŸŸ | |
| water_depth | 20.0 | |
| èˆ¹å‹ | æ²¹èˆ¹ | |

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å·¥å…·è°ƒç”¨è¯¦æƒ…</summary>

**è¯´æ˜**: æ ¹æ®æ°´åŸŸæ¡ä»¶æŸ¥è¡¨ 6.4.6-2

**å·¥å…·**: `table_lookup`

**è¾“å…¥**:
```json
{
  "table_name": "è¡¨ 6.4.6-2",
  "query_conditions": {
    "æ°´åŸŸæ¡ä»¶": "å—é™æ°´åŸŸ"
  },
  "file_name": "æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md"
}
```

**è¾“å‡º**:
```json
{
  "_source_html": "",
  "_table_name": "è¡¨ 6.4.6-2",
  "_table_headers": [
    "æ°´åŸŸæ¡ä»¶",
    "Z2 (m)"
  ],
  "_table_context": "è¡¨ 6.4.6-2 æ³¢æµªå¯Œè£•æ·±åº¦ Z2",
  "_trace": [
    "åŠ è½½çŸ¥è¯†åº“æ–‡ä»¶: æµ‹è¯•è§„èŒƒ-é€šèˆªåº•é«˜ç¨‹.md",
    "è¡¨æ ¼é€‰æ‹©ç­–ç•¥: Markdown ä¸Šä¸‹æ–‡å…¨åŒ¹é…",
    "åŒ¹é…è¡¨å: è¡¨ 6.4.6-2",
    "åŒ¹é…è¡¨æ ¼ä¸Šä¸‹æ–‡: è¡¨ 6.4.6-2 æ³¢æµªå¯Œè£•æ·±åº¦ Z2",
    "è§£æè¡¨å¤´: ['æ°´åŸŸæ¡ä»¶', 'Z2 (m)']",
    "æ–‡æœ¬æ¡ä»¶è¿‡æ»¤: {'æ°´åŸŸæ¡ä»¶': 'å—é™æ°´åŸŸ'}",
    "è‡ªåŠ¨æ¨æ–­ç›®æ ‡åˆ—: Z2 (m)"
  ],
  "result": 0.4,
  "method": "best_match_value"
}
```

</details>

---

## step_5: è·å–çºµå€¾å¯Œè£•æ·±åº¦ Z3

**LLM å°ç»“**:

æœ¬æ­¥éª¤ä¸ºæœ€ç»ˆè¾“å‡ºæ­¥éª¤ï¼ŒåŸºäºä¸Šä¸‹æ–‡æ•´ç†å¹¶å±•ç¤ºäº†æ‰€æœ‰å…³é”®å‚æ•°çš„è®¡ç®—ç»“æœã€‚

**Blackboard çŠ¶æ€**:

| Key | Value | Status |
| --- | --- | --- |
| **Z3** | **0.15** | ğŸŸ¢ Updated |
| H_nav | 0.5 | |
| T | 15.0 | |
| Z0 | 0.5 | |
| Z1 | 0.8 | |
| Z2 | 0.4 | |
| bottom_material | å²©çŸ³ | |
| dwt | 100000 | |
| nav_speed_kn | 10 | |
| navigation_area | å—é™æ°´åŸŸ | |
| water_depth | 20.0 | |
| èˆ¹å‹ | æ²¹èˆ¹ | |

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å·¥å…·è°ƒç”¨è¯¦æƒ…</summary>

**è¯´æ˜**: æ²¹èˆ¹/æ•£è´§èˆ¹å– 0.15m

**å·¥å…·**: `auto`

**è¾“å…¥**:
```json
{}
```

**è¾“å‡º**:
```json
0.15
```

</details>

---

## step_7: è®¡ç®—èˆªé“é€šèˆªæ°´æ·± D0

**LLM å°ç»“**:

åœ¨æ­¥éª¤â€œè®¡ç®—èˆªé“é€šèˆªæ°´æ·± D0â€ä¸­ï¼Œæˆ‘æ‰§è¡Œäº†è®¡ç®—ã€‚å…¬å¼ä¸º `15.0 + 0.5 + 0.8 + 0.4 + 0.15`ã€‚è®¡ç®—ç»“æœä¸º 16.85ï¼Œæ›´æ–°äº†ï¼šD0=16.85ã€‚

**Blackboard çŠ¶æ€**:

| Key | Value | Status |
| --- | --- | --- |
| **D0** | **16.85** | ğŸŸ¢ Updated |
| H_nav | 0.5 | |
| T | 15.0 | |
| Z0 | 0.5 | |
| Z1 | 0.8 | |
| Z2 | 0.4 | |
| Z3 | 0.15 | |
| bottom_material | å²©çŸ³ | |
| dwt | 100000 | |
| nav_speed_kn | 10 | |
| navigation_area | å—é™æ°´åŸŸ | |
| water_depth | 20.0 | |
| èˆ¹å‹ | æ²¹èˆ¹ | |

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å·¥å…·è°ƒç”¨è¯¦æƒ…</summary>

**è¯´æ˜**: D0 = T + Z0 + Z1 + Z2 + Z3

**å·¥å…·**: `calculator`

**è¾“å…¥**:
```json
{
  "expression": "15.0 + 0.5 + 0.8 + 0.4 + 0.15"
}
```

**è¾“å‡º**:
```json
{
  "result": 16.85,
  "expression": "15.0 + 0.5 + 0.8 + 0.4 + 0.15",
  "cleaned_expression": "15.0 + 0.5 + 0.8 + 0.4 + 0.15",
  "variables_used": {}
}
```

</details>

---

## step_8: è®¡ç®—é€šèˆªåº•æ ‡é«˜ E_nav

**LLM å°ç»“**:

åœ¨æ­¥éª¤â€œè®¡ç®—é€šèˆªåº•æ ‡é«˜ E_navâ€ä¸­ï¼Œæˆ‘æ‰§è¡Œäº†è®¡ç®—ã€‚å…¬å¼ä¸º `0.5 - 16.85`ã€‚è®¡ç®—ç»“æœä¸º -16.35ï¼Œæ›´æ–°äº†ï¼šE_nav=-16.35ã€‚

**Blackboard çŠ¶æ€**:

| Key | Value | Status |
| --- | --- | --- |
| **E_nav** | **-16.35** | ğŸŸ¢ Updated |
| D0 | 16.85 | |
| H_nav | 0.5 | |
| T | 15.0 | |
| Z0 | 0.5 | |
| Z1 | 0.8 | |
| Z2 | 0.4 | |
| Z3 | 0.15 | |
| bottom_material | å²©çŸ³ | |
| dwt | 100000 | |
| nav_speed_kn | 10 | |
| navigation_area | å—é™æ°´åŸŸ | |
| water_depth | 20.0 | |
| èˆ¹å‹ | æ²¹èˆ¹ | |

<details>
<summary>ç‚¹å‡»æŸ¥çœ‹å·¥å…·è°ƒç”¨è¯¦æƒ…</summary>

**è¯´æ˜**: E_nav = H_nav - D0

**å·¥å…·**: `calculator`

**è¾“å…¥**:
```json
{
  "expression": "0.5 - 16.85"
}
```

**è¾“å‡º**:
```json
{
  "result": -16.35,
  "expression": "0.5 - 16.85",
  "cleaned_expression": "0.5 - 16.85",
  "variables_used": {}
}
```

</details>

---

